# Chapter8. 스프링이란 무엇인가?

# 스프링의 정의
> 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크

-  `애플리케이션 프레임워크`
    - 특정 계층이나, 기술, 업무 분야에 국한되지 않고 애플리케이션의 전 영역을 포괄하는 범용적 프레임워크를 말한다.
    - 애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적인 목표를 두는 프레임워크다.
      자바 엔터프라이즈 개발의 이상적인 프로그래밍 모델을 추구하는데 필요한 기반이 돼주는 코드, 즉 프레임워크가 지금 스프링의 원시 버전이라 생각하면 된다.

`스프링의 일차적 존재 목적`
핵심 기술이 담긴 프로그래밍 모델을 일관되게 적용해서 엔터프라이즈 애플리케이션 전 계층과 전 영역에 전략과 기능을 제공해줌으로써 애플리케이션을 편리하게 개발하게 해주는 애플리케이션 프레임워크로 사용되는 것임

-  `경량급`
    - 스프링이 경량급이라는 건 스프링 자체가 가볍다거나 작은 규모의 코드로 이뤄졌다는 의미가 아니다.
    -  스프링은 20여개의 모듈로 세분화 되고 수십만 라인에 달하는 코드를 가진 매우 복잡하고 방대한 규모의 프레임워크다.
    -  Q. 왜 스프링이 가볍다고 하는 걸까?
        -  그것은 불필요하게 무겁지 않다는 걸 의미한다.
    - 가장 단순한 서버환경인 톰캣이나 제티에서도 완벽하게 동작한다.
    - 스프링이 가볍다는 건 기술 수준이 가벼운 것이 아니다. 생산성과 품질 면에서 유리하다는 의미로 가볍다는 것이다.

-  `자바 엔터프라이즈 개발을 편하게`
    - 개발자들이 스프링이라는 프레임워크가 제공하는 기술이 아니라 자신이 작성하는 애플리케이션 로직에 더 많은 관심을 쏟게 해준다.
    - 초기에 스프링의 기본 설정과 적용 기술만 잘 선택하고 준비하면, 이후 애플리케이션 개발 중에 스프링과 관련된 코드나 API 에 대해 개발자가 거의 신경 쓸 부분이 없다.

-  `오픈소스`
    - 소스가 모두에게 공개되고, 특별한 라이선스를 취득할 필요없이 얼마든지 가져다 자유롭게 이용해도 된다는 뜻이다.
    - 열람 뿐만 아니라 수정, 배포도 허용된다.
    -  `오픈소스의 장단점`
        -  `장점`
            - 공개된 커뮤니티 공간 안에서 투명한 방식으로 다양한 참여를 통해 개발되기 때문에 매우 빠르고 유연한 개발이 가능하다.
        -  `단점`
            - 지속적이고 안정적인 개발이 계속될지가 불확실하다.

하지만 스프링은 오픈소스의 장점을 충분히 취하면서 동시에 오픈소스 제품의 단점과 한계를 잘 극복하고 있는, 전문적이고 성공적인 오픈소스 소프트웨어이다.

# 스프링의 목적
**자바의 근본적인 목적**
객체지향 프로그래밍을 통해 유연하고 확장성 좋은 애플리케이션을 빠르게 만드는 것

스프링의 목적은 무엇인가?
경량급 프레임워크인 스프링을 활용해 엔터프라이즈 애플리케이션 개발을 편하게 하는 것이다.

굳이 스프링을 사용해서 엔터프라이즈 애플리케이션 개발을 편하게 하는 이유는 뭘까?
원래 엔터프라이즈 개발이란 편하지 않기 때문이다.

## 엔터프라이즈 개발의 복잡함
자바 엔터프라이즈 개발이 80% 이상이 실패
원인은?
여러가지 이유가 있었지만, '엔터프라이즈 시스템 개발이 너무 복잡해서'

### 복잡함의 근본적인 이유
1. `기술적인 제약조건과 요구사항이 늘어나기 때문이다.`
   엔터프라이즈 시스템이란 서버에서 동작하며 기업과 조직의 업무를 처리해주는 시스템이다.
   엔터프라이즈 시스템은 많은 사용자의 요청을 동시에 처리해야 돼서 서버의 자원을 효율적으로 공유하고 분배해서 사용할 수 있어야 한다.
   또한 보안과 안정성, 확정성 면에서도 뛰어나야 한다.
   **결론적으로 엔터프라이즈 시스템을 개발하는데는 순수한 비지니스 로직을 구현하는 것 외의 기술적으로 고려할 사항이 많다.**
2. `엔터프라이즈 애플리케이션이 구현해야 할 핵심기능인 비지니스 로직의 복잡함이 증가하기 때문이다.`
   버그나 오류가 있어서가 아니라, 기능 요구사항과 업무 정책 등이 바뀌기 때문에 애플리케이션을자주 수정해줘야 하는 시대가 됐다.

### 복잡함을 가중시키는 원인
자바 엔터프라이즈 시스템 개발이 어려운 가장 큰 이유는 근본적인 비지니스 로직과 엔터프라이즈 기술이라는 두 가지 복잡함이 한데 얽혀 있기 때문이다.
하나씩 놓고 봐도 만만치 않은데, 그 두 가지를 한 번에 다뤄야 하니 복잡함이 몇 배로 가중되는 것이다.

## 복잡함을 해결하기 위한 도전
### 제거될 수 없는 근본적인 복잡함
복잡함을 효과적으로 상대할 수 있는 전략과 기법이 필요하다.
비지니스 로직의 복잡함을 효과적으로 다루기 위한 방법과 기술적 복잡함을 효과적으로 처리하는데 적용되는 방법이 다르다.

- 실패한 해결책: EJB
    - EJB의 기본 전략도 위의 두 가지 종류의 복잡함을 분리하는 것
    - 개발자가 로우 레벨의 기술적인 복잡함에 신경 쓰지 않고 비지니스 로직을 효과적으로 개발하는 데 더 집중할 수 있게 하자는 목표
    - 기술적인 복잡함을 애플리케이션의 핵심 로직에서 일부분 분리하는데 성공
    - 애플리케이션 로직을 담은 핵심 코드에서 일부 기술적인 코드가 제거된 건 사실이지만, 오히려 EJB라는 환경과 스펙에 종속되는 코드로 만들어져야 하는 더 큰 부담을 안게 됐다.
    - 객체지향적인 특성은 잃어버린 밋밋한 서비스 스크립트성 코드로 변질됨

- 비침투적 방식을 통한 효과적인 해결책: 스프링
    - EJB의 실패를 교훈 삼아 출발
    - 비침투적 기술의 전략을 택해서 기술적인 복잡함과 비지니스 로직을 다루는 코드를 깔끔하게 분리함

`침투적 기술`
어떤 기술을 적용했을 때 그 기술과 관련된 코드나 규약 등이 코드에 등장하는 경우
ex) EJB

`비침투적 기술`
기술의 적용 사실이 코드에 직접 반영되지 않는다는 특징이 있다. 어딘가에는 기술의 적용에 따라 필요한 작업을 해줘야 하겠지만, 애플리케이션 코드 여기저기에 불쑥 등장하거나, 코드의 설계와 구현 방식을 제한하지 않는다.

## 복잡함을 상대하는 스프링 전략
### 기술적 복잡함을 상대하는 전략
스프링은 엔터프라이즈 기술을 적용했을 때 발생하는 복잡함의 문제를 두 가지로 분류하고 각각에 대한 적절한 대응 방법을 제공한다.
1. 기술에 대한 접근 방식이 일관성이 없고, 특정 환경에 종속적이다.
   서비스 추상화를 통해 해결
   기술적 복잡함은 일단 추상화를 통해 로우 레벨의 기술 구현 부분과 기술을 사용하는 인터페이스를 분리하고, 환경과 세부 기술에 독립적인 접근 인터페이스를 제공하는 것이 가장 좋은 해결책
2. 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장한다.
   기술과 비지니스 로직의 혼재로 발생하는 복잡함을 해결하기 위한 스프링의 접근 방법이 AOP 이다.
   AOP 는 최후까지 애플리케이션 로직을 담당하는 코드에 남아 있는 기술 관련 코드를 깔끔하게 분리해서 별도의 모듈로 관리하게 해주는 강력한 기술이다.
   AOP 는 기술을 다루는 코드로 인한 복잡함이 기술 그 자체 이상으로 불필요하게 증대되지 않도록 도와주는 가장 강력한 수단이다.
### 비지니스와 애플리케이션 로직의 복잡함을 상대하는 전략
비지니스 로직은 가장 중요하게 다뤄져야 하고 가장 많이 신경 써야 한다.
`과거`
비지니스 로직의 상당 부분을 DB에 두는 것이 유행
SQL 을 통해 비지니스 로직을 표현하고, DB에서 동작하는 저장 프로시저를 통해 핵심 로직을 처리하는 경우가 많았다.

`현재`
비지니스 로직은 애플리케이션 안에서 처리하도록 만드는 추세다.
DB는 단지 데이터의 영구 저장과 복잡한 조건을 가진 검색과 같은 자체적으로 특화된 기능에만 활용, 데이터를 분석/가공에 따라 로직을 처리하는 부분은 확장하기 쉽고, 비용도 싼 애플리케이션 서버 쪽으로 이동

### 핵심 도구: 객체지향과 DI
기술과 비지니스 로직의 복잡함을 해결하는데 스프링이 공통적으로 사용하는 도구가 객체지향이다.
자바의 기본인 객체지향에 충실한 설계가 가능하도록 단순한 오브젝트로 개발할 수 있고, 객체지향의 설계 기법을 잘 적용할 수 있는 구조를 만들기 위해 DI 같은 유용한 기술을 편하게 적용하도록 도와주는 것이 **스프링의 기본 전략**이다.

객체지향적인 특성을 잘 살린 설계는 상속과 다형성, 위임을 포함해서 많은 객체지향 디자인 패턴과 설계 기법이 잘 녹아들 수 있다.
모든 스프링의 기술과 전략은 객체지향이라는 자바 언어가 가진 강력한 도구를 극대화해서 사용할 수 있도록 돕는 것이다.

# POJO  프로그래밍
> 스프링의 정수(essence)는 엔터프라이즈 서비스 기능을 POJO에 제공하는 것

## 스프링의 핵심 : POJO
스프링의 주요 기술인 IoC/DI, AOP와 PSA 는 애플리케이션을 POJO 로 개발할 수 있게 해주는 가능 기술이라 불린다.
## POJO란 무엇인가?
POJO는 Plain Old Java Object 의 첫 글자를 따서 만든 약자다.
- 마틴 파울러

## POJO 의 조건
- 특정 규약에 종속되지 않는다.
  규약에 종속되지 않아야 하고, 객체지향 설계의 자유로운 적용이 가능한 오브젝트
- 특정 환경에 종속되지 않는다.

진정한 POJO 란 객체지향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트이다.
그런 POJO 에 애플리케이션의 핵심 로직과 기능을 담아 설계하고 개발하는 방법을 POJO 프로그래밍이라 한다.

## POJO 의 장점
- 특정한 기술과 환경에 종속되지 않은 오브젝트기 때문에 그만큼 깔끔한 코드가 될 수 있다.
- 어떤 환경에도 종속되지 않기 때문에 매우 유연한 방식으로 원하는 레벨에서 코드를 빠르고 명확하게 테스트할 수 있다.
- 객체지향적인 설계를 자유롭게 적용할 수 있다.
## POJO 프레임워크
스프링 프레임워크와 하이버네이트가 대표적인 POJO 프레임워크이다.
주로 DB 이용 기술에 POJO 를 적용하는 것을 목적으로 하는 하이버네이트와 달리, 스프링은 엔터프라이즈 애플리케이션 개발의 모든 영역과 계층에서 POJO 방식의 구현이 가능하게 하려는 목적으로 만들어졌다.
![[Pasted image 20241204014441.png]]
스프링은 비지니스 로직의 복잡함과 엔터프라이즈 기술의 복잡함을 분리해서 구성할 수 있게 도와준다. 하지만 자신은 기술 영역에만 관여하지 비지니스 로직을 담당하는 POJO 에서는 모습을 감춘다.
데이터 액세스 로직이나 웹 UI 로직을 다룰 때만 최소한의 방법으로 관여한다.
# 스프링의 기술
## 제어의 역전/ 의존관계 주입
Q. 왜 두 개의 오브젝트를 분리해서 만들고, 인터페이스를 두고 느슨하게 연결한 뒤, 실제 사용할 대상은 DI를 통해 외부에서 지정하는 것일까?
이렇게 DI 방식으로 하는 것이 그렇지 않은 경우, 즉 직접 자신이 사용할 오브젝트를 new 키워드로 생성해서 사용하는 강한 결합을 쓰는 방법보다 나은 점은?
A. 유연한 확장이 가능하게 하기 위해서이다.

DI 는 개방 폐쇄 원칙이라는 객체지향 설계 원칙으로 잘 설명된다.
OCP 의 변경에는 닫혀 있다. 폐쇄 관점에서 볼 때 장점은 재사용이 가능하다라는 것이다.

### DI 활용 방법
- 핵심기능의 변경
  DI 의 가장 대표적인 적용 방법은 바로 의존 대상의 구현을 바꾸는 것
  예를 들면, 서비스 오브젝트가 사용하는 DAO 가 있다고 할 때, DAO 의 구현을JDBC로 했다가, 그것을 JPA, 하이버네이트, JDO, iBatis 등으로 변경하는 것을 생각하면 된다.
  구현 방식을 통째로 바꾸는 것이다.
  실제 의존하는 대상이 가진 핵심기능을 DI 설정을 통해 변경하는 것이 대표적인 DI 활용 방법이다.
- 핵심기능의 동적인 변경
  첫 번째랑 비슷하게 의존 오브젝트의 핵심 기능 자체를 바꾸는 것이다.
  하지만 일반적인 DI 를 이용하는 방법과 달리, 동적으로 매번 다르게 변경할 수 있다.
  DI 도 기본적으로는 런타임 시 동적으로 의존 오브젝트를 연결해주는 것이긴 하지만, 일단 DI 되고 나면 그 후로는 바뀌지 않는다.
  즉, 동적인 방식으로 연결되지만 한 번 DI 되면 바뀌진 않는 정적인 관계를 맺어주는 것이다.
  하지만 DI 를 잘 활용하면 애플리케이션이 동작하는 중간에 그 의존대상을 다이내믹하게 변경할 수 있다.
- 부가기능의 추가
  핵심 기능은 그대로 둔 채로 부가기능을 추가하는 것
  데이레이터 패턴을 생각해보면 된다.
  인터페이스를 두고 사용하게 하고, 실제 사용할 오브젝트는 외부에서 주입하는 DI 를 적용해두면 데코레이터 패턴을 쉽게 적용할 수 있다. 그래서 핵심기능과 클라이언트 코드에는 전혀 영향을 주지 않으면서 부가적인 기능을 얼마든지 추가할 수 있다.
  트랜잭션 기능을 부여했던 것이 대표적인 예시
- 인터페이스 변경
  때로 사용하려고 하는 오브젝트가 가진 인터페이스가 클라이언트와 호환되지 않는 경우도 있다.
  또는 여러 종류의 인터페이스를 가졌지만 사실 비슷한 기능을 담당하는 오브젝트를 바꿔가면서사용하고 싶을 때도 있다. 이렇게 클라이언트가 사용하는 인터페이스와 실제 오브젝트 사이에 인터페이스가 일치하지 않는 경우에도 DI 가 유용하다.
  PSA는 클라이언트가 일관성 있게 사용할 수 있는 인터페이스를 정의해주고 DI 를 통해 어댑터 역할을 하는 오브젝트를 이용하게 해준다.
- 프록시
  프록시 패턴의 전형적인 응용방법도 있다. 필요한 시점에서 실제 사용할 오브젝트를 초기화하고 리소스를 준비하게 해주는 지연된 로딩을 적용하려면 프록시가 필요하다.
  원격 오브젝트를 호출할 때 마치 로컬에 존재하는 오브젝트처럼 사용할 수 있게 해주는 원격 프록시를 적용하려고 할 때도 프록시가 필요하다.
  두가지 방법 모두 DI 를 필요로 한다.
  스프링은 EJB 원격 호출을 포함해 웹서비스, REST 호출, HTTP 방식의 호출 등 다양한 리모팅 기술을 지원한다.( DI 활용)
- 템플릿과 콜백
  반복적으로 등장하지만 항상 고정적인 작업 흐름과 그 사이에서 자주 바뀌는 부분을 분리해서 템플릿과 콜백으로 만들고 이를 DI 원리를 응용해 적용하면 지저분하게 매번 만들어야 하는 코드를 간결하게 만들 수 있다.
- 싱글톤과 오브젝트 스코프
  DI 가 필요한 중요한 이유 중 한가지는 DI 할 오브젝트의 생명주기를 제어할 수 있다는 것이다.
  DI 를 프레임워크로 이용한다는 건 DI 대상 오브젝트를 컨테이너가 관리한다는 의미이다.
- 테스트
  여타 오브젝트와 협력해서 동작하는 오브젝트를 효과적으로 테스트하는 방법은 가능한 한 고립시키는 것이다.
## 애스펙트 지향 프로그래밍 (AOP)
## AOP 적용 기법
1. 스프링과 같이 다이내믹 프록시를 사용하는 방법
2. 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법
### AOP 적용 단계
1. 미리 준비된 AOP 이용
2. 전달팀을 통한 정책 AOP 적용
3. AOP 의 자유로운 이용
## 포터블 서비스 추상화 (PSA)
환경과 세부 기술의 변화에 관계없이 일관된 방식으로 기술에 접근할 수 있게 해주는 PSA
# 정리
- 스프링은 그 개발 철학과 목표를 분명히 이해하고 사용해야 한다.
- 스프링은 오픈소스 소프트웨어이며, 애플리케이션 개발의 모든 기술과 영역을 종합적으로 다루는 애플리케이션 프레임워크다.
- 엔터프라이즈 애플리케이션 개발의 복잡함은 비지니스 로직과 엔터프라이즈 시스템의 기술적인 요구에 의해 발생한다. 기존의 접근 방법은 이 복잡도를 낮추지 못 하며 자바의 객체지향적인 장점을 포기해야 한다는 문제점이 있다.
- 자바의 근본인 객체지향적인 원리에 충실하게 개발할 수 있으며, 환경과 규약에 의존적이지 않은 POJO 를 이용한 애플리케이션 개발은 엔터프라이즈 시스템 개발의 복잡함이 주는 많은 문제를 해결할 수 있다.
- 스프링의 목적 이런 POJO 를 이용해 엔터프라이즈 애플리케이션을 쉽고 효과적으로 개발할 수 있도록 지원해주는데 있다.
- POJO 방식의 개발을 돕기 위해 스프링은 IoC/DI, AOP, PSA 와 같은 기능기술을 프레임워크와 컨테이너라는 방식을 통해 제공한다.